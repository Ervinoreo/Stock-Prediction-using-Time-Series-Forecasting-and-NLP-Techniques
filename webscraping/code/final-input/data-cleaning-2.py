# -*- coding: utf-8 -*-
"""Final Data Cleaning.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1ZxDEYFcVTCJiX_cf1sB1o-IvzdovtTWK
"""

import csv

with open("tesla_data.csv", "r") as file:
  reader = csv.reader(file)
  data = list(reader)
  data[0].extend(["Percentage_change", "Combine"])

print(data[0])

result = [["Dates", "Closed_Price", "Percentage_change", "Combine_headlines"]]

date = data[1][1]
price = data[1][3]
percentage = 0
row = []
combine_sentence = data[1][0] + " " + data[1][2] + " "
row.extend([date, price, percentage])

print(row)

for i in range(2, len(data)):
  if data[i][3] == price and data[i][1] == date:
    sentence = data[i][0] + " " + data[i][2] + " "
    combine_sentence += sentence
  else:
    row.append(combine_sentence)
    result.append(row)
    percentage = (float(data[i][3]) - float(price)) * 100 / float(price)
    date = data[i][1]
    price = data[i][3]
    row = []
    combine_sentence = data[i][0] + " " + data[1][2] + " "
    row.extend([date, price, percentage])

row.append(combine_sentence)
result.append(row)

with open('Tesla_Final.csv', 'w', newline='') as file:
    writer = csv.writer(file)
    writer.writerows(result)

print("CSV file edited successfully.")

